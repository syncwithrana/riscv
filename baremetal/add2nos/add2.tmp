# -------- add2_loop.gdb --------
set pagination off
set confirm off
set verbose off

set architecture riscv:rv32
target remote :1234

break _start
continue

echo \n--- Disassembly at _start ---\n
disassemble _start

echo \n--- Stepping instructions ---\n

# Save previous PC
set $prev_pc = 0

while 1
    set $curr_pc = $pc

    # Detect infinite loop (PC not changing)
    if $curr_pc == $prev_pc
        echo \n--- Reached infinite loop, exiting ---\n
        info registers t0 t1 t2
        quit
    end

    set $prev_pc = $curr_pc

    si

    printf "PC=0x%x  ", $pc
    info registers t0 t1 t2
end
